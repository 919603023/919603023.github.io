<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <title>Starcoin的stdlib升级和Dao链上治理 | WGB的小破站</title><meta name="description" content="分享技术，开源万岁">
    <link rel="preload" href="/assets/js/runtime~app.fa156efa.js" as="script"><link rel="preload" href="/assets/css/styles.9f21223e.css" as="style"><link rel="preload" href="/assets/js/1773.b136e78e.js" as="script"><link rel="preload" href="/assets/js/app.7a04ff8e.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.9f21223e.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="WGB的小破站"><span class="site-name can-hide">WGB的小破站</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/contents" class="nav-link" aria-label="目录"><!--[--><!--]--> 目录 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="前端技术"><span class="title">前端技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="前端技术"><span class="title">前端技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/front/html" class="nav-link" aria-label="HTML"><!--[--><!--]--> HTML <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/css" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/javascript" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/vue" class="nav-link" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="后端技术"><span class="title">后端技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="后端技术"><span class="title">后端技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/back/golang" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/java" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/python" class="nav-link" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/rust" class="nav-link" aria-label="Rust"><!--[--><!--]--> Rust <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="区块链技术"><span class="title">区块链技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="区块链技术"><span class="title">区块链技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blockchain/Starcoin" class="nav-link" aria-label="Starcoin"><!--[--><!--]--> Starcoin <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blockchain/DF" class="nav-link" aria-label="Dark Forest"><!--[--><!--]--> Dark Forest <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/other/regex" class="nav-link" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/git" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/linux" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/docker" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/environment" class="nav-link" aria-label="环境设置"><!--[--><!--]--> 环境设置 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/miner" class="nav-link" aria-label="挖矿"><!--[--><!--]--> 挖矿 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/contents" class="nav-link" aria-label="目录"><!--[--><!--]--> 目录 <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="前端技术"><span class="title">前端技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="前端技术"><span class="title">前端技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/front/html" class="nav-link" aria-label="HTML"><!--[--><!--]--> HTML <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/css" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/javascript" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/front/vue" class="nav-link" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="后端技术"><span class="title">后端技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="后端技术"><span class="title">后端技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/back/golang" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/java" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/python" class="nav-link" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/back/rust" class="nav-link" aria-label="Rust"><!--[--><!--]--> Rust <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="区块链技术"><span class="title">区块链技术</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="区块链技术"><span class="title">区块链技术</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blockchain/Starcoin" class="nav-link" aria-label="Starcoin"><!--[--><!--]--> Starcoin <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blockchain/DF" class="nav-link" aria-label="Dark Forest"><!--[--><!--]--> Dark Forest <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/other/regex" class="nav-link" aria-label="正则表达式"><!--[--><!--]--> 正则表达式 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/git" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/linux" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/docker" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/environment" class="nav-link" aria-label="环境设置"><!--[--><!--]--> 环境设置 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/miner" class="nav-link" aria-label="挖矿"><!--[--><!--]--> 挖矿 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Starcoin的stdlib升级和Dao链上治理</p><ul class=""><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#一、智能合约-starcoin-vs-eth" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="一、智能合约：Starcoin vs ETH"><!--[--><!--]--> 一、智能合约：Starcoin vs ETH <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_1-智能合约所使用的语言" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1. 智能合约所使用的语言"><!--[--><!--]--> 1. 智能合约所使用的语言 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_2-智能合约的调用与存储" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="2. 智能合约的调用与存储"><!--[--><!--]--> 2. 智能合约的调用与存储 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#二、智能合约升级-starcoin-vs-eth" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="二、智能合约升级：Starcoin vs ETH"><!--[--><!--]--> 二、智能合约升级：Starcoin vs ETH <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#三、合约升级方案-starcoin-vs-eth" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="三、合约升级方案：Starcoin VS ETH"><!--[--><!--]--> 三、合约升级方案：Starcoin VS ETH <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_1-pending" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1. PENDING"><!--[--><!--]--> 1. PENDING <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_2-active" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="2. ACTIVE"><!--[--><!--]--> 2. ACTIVE <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_3-agreed" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="3. AGREED"><!--[--><!--]--> 3. AGREED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_4-queued" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="4.QUEUED"><!--[--><!--]--> 4.QUEUED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_5-exectable" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="5.EXECTABLE"><!--[--><!--]--> 5.EXECTABLE <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_6-etracted" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="6.ETRACTED"><!--[--><!--]--> 6.ETRACTED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_7-upgrade-complete" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="7.Upgrade complete"><!--[--><!--]--> 7.Upgrade complete <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#四、合约升级流程操作展示" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="四、合约升级流程操作展示"><!--[--><!--]--> 四、合约升级流程操作展示 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_1-编写stdlib中的代码" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1. 编写stdlib中的代码"><!--[--><!--]--> 1. 编写stdlib中的代码 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_2-准备编译好的二进制的module" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="2. 准备编译好的二进制的Module"><!--[--><!--]--> 2. 准备编译好的二进制的Module <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_3-准备账号以及余额" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="3. 准备账号以及余额"><!--[--><!--]--> 3. 准备账号以及余额 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_4-提交提案-进入-pending" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="4. 提交提案 进入 PENDING"><!--[--><!--]--> 4. 提交提案 进入 PENDING <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_5-查询提案的状态" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="5. 查询提案的状态"><!--[--><!--]--> 5. 查询提案的状态 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_6-等待社区议论-进入-active" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="6. 等待社区议论 进入 ACTIVE"><!--[--><!--]--> 6. 等待社区议论 进入 ACTIVE <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_7-社区投票-进入-agreed" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="7. 社区投票 进入 AGREED"><!--[--><!--]--> 7. 社区投票 进入 AGREED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_8-agreed的提议放入更新队列-进入queued" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="8. AGREED的提议放入更新队列 进入QUEUED"><!--[--><!--]--> 8. AGREED的提议放入更新队列 进入QUEUED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_9-公示期等待-进入exectable" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="9. 公示期等待 进入EXECTABLE"><!--[--><!--]--> 9. 公示期等待 进入EXECTABLE <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_10-提交升级计划-进入etracted" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="10. 提交升级计划  进入ETRACTED"><!--[--><!--]--> 10. 提交升级计划  进入ETRACTED <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_11-提交代码-进入upgrade-complete" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="11. 提交代码 进入Upgrade complete"><!--[--><!--]--> 11. 提交代码 进入Upgrade complete <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_12-完成合约升级流程" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="12. 完成合约升级流程"><!--[--><!--]--> 12. 完成合约升级流程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blockchain/StarCoin/_blog/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86/Starcoin%E7%9A%84stdlib%E5%8D%87%E7%BA%A7%E5%92%8CDao%E9%93%BE%E4%B8%8A%E6%B2%BB%E7%90%86.html#_13-升级的验证" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="13. 升级的验证"><!--[--><!--]--> 13. 升级的验证 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="starcoin的stdlib升级和dao链上治理" tabindex="-1"><a class="header-anchor" href="#starcoin的stdlib升级和dao链上治理" aria-hidden="true">#</a> Starcoin的stdlib升级和Dao链上治理</h1><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>* 本文由Starcoin社区原创 作者:WGB
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h1 id="starcoin" tabindex="-1"><a class="header-anchor" href="#starcoin" aria-hidden="true">#</a> Starcoin</h1><p>  Starcoin 与其他币种不同，Starcoin把的共识、区块设置、区块奖励、账号定义、Token定义、NFT协议等预先定义在stdlib中，以便升级维护统一管理。stdlib是存在于链上的合约库，所以starcoin 可以不使用硬编码来实现区块奖励、区块算法、共识等定义，同时stdlib也可以通过Dao链上治理的方式进行升级或修复。</p><h2 id="一、智能合约-starcoin-vs-eth" tabindex="-1"><a class="header-anchor" href="#一、智能合约-starcoin-vs-eth" aria-hidden="true">#</a> 一、智能合约：Starcoin vs ETH</h2><h3 id="_1-智能合约所使用的语言" tabindex="-1"><a class="header-anchor" href="#_1-智能合约所使用的语言" aria-hidden="true">#</a> 1. 智能合约所使用的语言</h3><table><thead><tr><th>项目</th><th>区别</th></tr></thead><tbody><tr><td>ETH</td><td>以太坊的智能合约一般使用solidity语言编写(无标准库)</td></tr><tr><td>Starcoin</td><td>Starcoin使用move语言编写。 在move语言中分module和script，有stdlib(官方的标准库)</td></tr></tbody></table><p><strong>以太坊：</strong></p><blockquote><p>  以太坊的合约大多时使用solidity编写，在编写过程中如ERC20等协议的代币需要编写时自己实现，没有stdllib标准库。</p></blockquote><p><strong>Starcoin:</strong></p><blockquote><p>  Starcoin的合约使用move语言编写，move语言有module和script的概念，module大多用来编写基础代码，通过script来组合调用。在Starcoin中有stdlib，内置实现了ERC20、NFT、Dao等协议，同时move语言支持范型，可以方便的创建出不同的Token以及其他功能。</p></blockquote><h3 id="_2-智能合约的调用与存储" tabindex="-1"><a class="header-anchor" href="#_2-智能合约的调用与存储" aria-hidden="true">#</a> 2. 智能合约的调用与存储</h3><table><thead><tr><th>项目</th><th>区别</th></tr></thead><tbody><tr><td>ETH</td><td>以太坊调用智能合约是 <strong>合约地址</strong> + <strong>方法</strong> + <strong>数据</strong></td></tr><tr><td>Starcoin</td><td>Starcoin调用智能合约是 通过 <strong>拥有者地址</strong> + <strong>模块</strong> + <strong>方法</strong> + <strong>数据</strong></td></tr></tbody></table><p><strong>以太坊：</strong></p><blockquote><p>  <strong>以太坊</strong>分为合约地址与非合约地址，合约需要放在合约地址，所以在调用合约时需要通过合约的地址来找到合约。如果合约升级，在不使用Proxy contract (代理合约)等方法时，需要改变合约地址才能使用新的合约。</p></blockquote><p><strong>Starcoin:</strong></p><blockquote><p>  <strong>Starcoin</strong>的合约以及其他资源(Token、NFT ...)是存储在账户地址，所以在调用合约时需要通过<strong>拥有者地址</strong>+<strong>模块</strong> 来找到合约。如果合约升级，不会影响调用合约的地址和模块名称。</p></blockquote><h2 id="二、智能合约升级-starcoin-vs-eth" tabindex="-1"><a class="header-anchor" href="#二、智能合约升级-starcoin-vs-eth" aria-hidden="true">#</a> 二、智能合约升级：Starcoin vs ETH</h2><table><thead><tr><th>项目</th><th>区别</th></tr></thead><tbody><tr><td>ETH</td><td>合约升级意味着新的合约地址 <strong>约等于</strong> 一个新的合约 需要修改合约地址才能访问新的合约</td></tr><tr><td>Starcoin</td><td>合约升级不影响合约调用依然使用老合约的<strong>拥有者地址</strong> + <strong>模块</strong> + <strong>方法</strong> + <strong>数据</strong>方法就可以调用新合约</td></tr></tbody></table><p><strong>以太坊：</strong></p><blockquote><p>  以太坊上的合约需要升级但不希望更改调用的地址时可以使用Proxy contract (代理合约)，访问代理合约的地址，由代理合约提供新合约的地址。</p></blockquote><p><strong>Starcoin：</strong></p><blockquote><p>  Starcoin的合约需要升级时Dao去中心化社区投票、Two-phase (两阶段提交)来解决，在升级后就可以使用原地址调用新合约。</p></blockquote><h2 id="三、合约升级方案-starcoin-vs-eth" tabindex="-1"><a class="header-anchor" href="#三、合约升级方案-starcoin-vs-eth" aria-hidden="true">#</a> 三、合约升级方案：Starcoin VS ETH</h2><p><img src="/assets/img/合约升级流程.b16bcb77.jpg" alt="合约升级方案流程">   Starcoin的stdlib合约存在于链上，采用Dao去中心化的管理，社区可通过投票操作来决定合约升级计划的部署等。<br>   代码提交是采用两阶段提交：先提交升级计划，再提交更新代码。<br> 整个流程分为七个阶段：</p><ol><li>PENDING</li><li>ACTIVE</li><li>AGREED</li><li>QUEUED</li><li>EXECTABLE</li><li>ETRACTED</li><li>Upgrade complete</li></ol><h3 id="_1-pending" tabindex="-1"><a class="header-anchor" href="#_1-pending" aria-hidden="true">#</a> 1. PENDING</h3><p>  在coder 修改代码后向Dao提交一个升级的proposal txn，整个流程进入PENDING状态。设置有一段时间使社区对该项议题讨论和了解后进入下一个阶段。</p><h3 id="_2-active" tabindex="-1"><a class="header-anchor" href="#_2-active" aria-hidden="true">#</a> 2. ACTIVE</h3><p>  在上个阶段的结束后，进入ACTIVE阶段，在这个阶段需要社区的人员进行投票，在到达设置的规定时间后转为下个阶段。</p><h3 id="_3-agreed" tabindex="-1"><a class="header-anchor" href="#_3-agreed" aria-hidden="true">#</a> 3. AGREED</h3><p>  在上个阶段到达规定时间后，流程进入到AGREED阶段，在这个阶段中会对投票结果进行统计，如果超过预定占比，则视为升级计划被Dao社区允许，在发起公示后，可以进行下一个阶段。</p><h3 id="_4-queued" tabindex="-1"><a class="header-anchor" href="#_4-queued" aria-hidden="true">#</a> 4.QUEUED</h3><p>  在上个阶段的投票结果统计后，流程进入由发起公示后到公示期，这个阶段主要是展示发起人和proposal的信息等，当公示期过去之后进入下个阶段。</p><h3 id="_5-exectable" tabindex="-1"><a class="header-anchor" href="#_5-exectable" aria-hidden="true">#</a> 5.EXECTABLE</h3><p>  在上个阶段的公示期时间结束后，流程进入到可以升级合约的Two-phase（两阶段提交）的第一个阶段，提交合约代码升级计划。在提交完合约升级计划后即可进入下一个阶段。</p><h3 id="_6-etracted" tabindex="-1"><a class="header-anchor" href="#_6-etracted" aria-hidden="true">#</a> 6.ETRACTED</h3><p>  在上个阶段的提交合约升级计划后，流程进入到升级合约的Two-phase（两阶段提交）的第二个阶段，在此阶段可以提交修复或升级合约的代码，在提交完成后即可进入下个阶段。</p><h3 id="_7-upgrade-complete" tabindex="-1"><a class="header-anchor" href="#_7-upgrade-complete" aria-hidden="true">#</a> 7.Upgrade complete</h3><p>  在上个阶段的代码提交后，整个合约升级流程结束，在此之后可以使用新的合约代码进行操作。</p><h2 id="四、合约升级流程操作展示" tabindex="-1"><a class="header-anchor" href="#四、合约升级流程操作展示" aria-hidden="true">#</a> 四、合约升级流程操作展示</h2><h3 id="_1-编写stdlib中的代码" tabindex="-1"><a class="header-anchor" href="#_1-编写stdlib中的代码" aria-hidden="true">#</a> 1. 编写stdlib中的代码</h3><blockquote><p>此处以stdlib中的<strong>DummyToken.move</strong>为例，增加一个Mymint函数和Mymint脚本。功能为定值造100个DummyToken。</p></blockquote><p><strong>DummyToken.move下的 DummyToken Module ：</strong></p><div class="language-Move ext-Move line-numbers-mode"><pre class="language-Move"><code>  /// Anyone can mint DummyToken, amount should &lt; 10000
    public fun mint(_account: &amp;signer, amount: u128) : Token&lt;DummyToken&gt; acquires SharedMintCapability{
        assert(amount &lt;= 10000, Errors::invalid_argument(EMINT_TOO_MUCH));
        let cap = borrow_global&lt;SharedMintCapability&gt;(token_address());
        Token::mint_with_capability(&amp;cap.cap, amount)
    }

    // 在此增加新的函数 
    public fun Mymint(_account: &amp;signer) : Token&lt;DummyToken&gt; acquires SharedMintCapability{
        let cap = borrow_global&lt;SharedMintCapability&gt;(token_address());
        Token::mint_with_capability(&amp;cap.cap, 100)
    }

    /// Return the token address.
    public fun token_address(): address {
        Token::token_address&lt;DummyToken&gt;()
    }
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>DummyToken.move下的 DummyTokenScripts Module ：</strong></p><div class="language-move ext-move line-numbers-mode"><pre class="language-move"><code>    public(script) fun mint(sender: signer, amount: u128){
        let token = DummyToken::mint(&amp;sender, amount);
        let sender_addr = Signer::address_of(&amp;sender);
        if(Account::is_accept_token&lt;DummyToken&gt;(sender_addr)){
            Account::do_accept_token&lt;DummyToken&gt;(&amp;sender);
        };
        Account::deposit(sender_addr, token);
    }

    //在此增加新的脚本函数
    public(script) fun Mymint(sender:signer){
        let token = DummyToken::Mymint(&amp;sender);
        let sender_addr = Signer::address_of(&amp;sender);
        if(Account::is_accept_token&lt;DummyToken&gt;(sender_addr)){
            Account::do_accept_token&lt;DummyToken&gt;(&amp;sender);
        };
        Account::deposit(sender_addr, token);
    }
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_2-准备编译好的二进制的module" tabindex="-1"><a class="header-anchor" href="#_2-准备编译好的二进制的module" aria-hidden="true">#</a> 2. 准备编译好的二进制的Module</h3><blockquote><p>在Starcoin 命令行中执行命令，分两步编译、打包出二进制的 Module <strong>编译：</strong></p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>执行：
    dev compile -s 0x1 path/to/DummyToken.move

结果：
    <span class="token punctuation">{</span>
        <span class="token string">&quot;ok&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;path/to/DummyToken.mv&quot;</span>,
            <span class="token string">&quot;path/to/DummyTokenScripts.mv&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>打包：</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>执行：
    dev package -n MymintUpgrade -o storage path/to/DummyToken*

结果：
    <span class="token punctuation">{</span>
        <span class="token string">&quot;ok&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;file&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;path/to/storage/MymintUpgrade.blob&quot;</span>,
            <span class="token string">&quot;package_hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0x6e54935144115233c9decb255d3bcd5f14c7b9d82c968c5f3a0cb1b14f18bce8&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_3-准备账号以及余额" tabindex="-1"><a class="header-anchor" href="#_3-准备账号以及余额" aria-hidden="true">#</a> 3. 准备账号以及余额</h3><p><strong>准备账号：</strong></p><blockquote><p>需要两个账号：</p><ol><li>coder账号：   用来提交计划和提交代码等</li><li>投票代表账号：  用来投票</li></ol></blockquote><blockquote><p>使用密钥导入或使用account create 创建账号即可 <strong>准备余额：</strong></p><ol><li>coder账号需要一定的STC作为提案和升级等操作的GAS费。</li><li>投票代表账号需要大量的STC作为投票的票数。 使用命令行 account unlock <strong>账户地址</strong> 解锁账户 <strong>获取STC方法：</strong></li></ol></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>默认账户获取：
    dev get-coin -v 6000000STC
转账方式：
    account transfer -s 0x0000000000000000000000000a550c18 -r <span class="token operator">&lt;</span>账号收款识别码<span class="token operator">&gt;</span> -v <span class="token number">60000000000000000</span> -b
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4-提交提案-进入-pending" tabindex="-1"><a class="header-anchor" href="#_4-提交提案-进入-pending" aria-hidden="true">#</a> 4. 提交提案 进入 PENDING</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>提交提案：
    dev module-proposal -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span> -m <span class="token operator">&lt;</span>module path<span class="token operator">&gt;</span> -v <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span> -e <span class="token boolean">false</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><ul><li>-m 表示升级包的路径；</li><li>-v 表示新的版本号；</li><li>-e 表示是否跳过 module 兼容性检查强制升级，false 表示不跳过兼容性检查，缺省不跳过。</li></ul></blockquote><h3 id="_5-查询提案的状态" tabindex="-1"><a class="header-anchor" href="#_5-查询提案的状态" aria-hidden="true">#</a> 5. 查询提案的状态</h3><p><strong>查看提议id:</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dev call --function 0x1::Dao::proposal_info -t 0x1::STC::STC -t 0x1::UpgradeModuleDaoProposal::UpgradeModuleV2 --arg <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><strong>查看提议状态:</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>    dev call --function 0x1::Dao::proposal_state -t 0x1::STC::STC -t 0x1::UpgradeModuleDaoProposal::UpgradeModuleV2 --arg <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span> --arg <span class="token operator">&lt;</span>proposal_id<span class="token operator">&gt;</span>
结果:
    <span class="token punctuation">{</span>
        <span class="token string">&quot;ok&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token operator">&lt;</span>state_num<span class="token operator">&gt;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_6-等待社区议论-进入-active" tabindex="-1"><a class="header-anchor" href="#_6-等待社区议论-进入-active" aria-hidden="true">#</a> 6. 等待社区议论 进入 ACTIVE</h3><blockquote><p>在PENDING状态下经过一段时间进入投票期,在dev下可以通过sleep方式加快区块链时间进入下个阶段。 <strong>加速进入：</strong></p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>加速时间：
    dev <span class="token function">sleep</span> -t <span class="token number">3600000</span>
生成块（生效时间）：
    dev gen-block
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>查看提案状态：</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>执行：
    dev call --function 0x1::Dao::proposal_state -t 0x1::STC::STC -t 0x1::UpgradeModuleDaoProposal::UpgradeModuleV2 --arg <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span> --arg <span class="token operator">&lt;</span>proposal_id<span class="token operator">&gt;</span>
结果：
    <span class="token punctuation">{</span>
        <span class="token string">&quot;ok&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token number">2</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
转为ACTIVE状态
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_7-社区投票-进入-agreed" tabindex="-1"><a class="header-anchor" href="#_7-社区投票-进入-agreed" aria-hidden="true">#</a> 7. 社区投票 进入 AGREED</h3><blockquote><p>用投票代表账号参与投票后等待投票时间结束后，流程进入AGREED阶段</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>投票：
    account execute-function -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span> --function 0x1::DaoVoteScripts::cast_vote -t 0x1::STC::STC -t 0x1::UpgradeModuleDaoProposal::UpgradeModuleV2 --arg <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span> --arg <span class="token operator">&lt;</span>proposal_id<span class="token operator">&gt;</span> --arg <span class="token boolean">true</span> --arg 59000000000000000u128
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_8-agreed的提议放入更新队列-进入queued" tabindex="-1"><a class="header-anchor" href="#_8-agreed的提议放入更新队列-进入queued" aria-hidden="true">#</a> 8. AGREED的提议放入更新队列 进入QUEUED</h3><blockquote><p>在进入AGREED 以后，任何人都可以将状态为 AGREED 的提议放入更新队列。</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dev module-queue -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span> -a <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span> -i <span class="token operator">&lt;</span>proposal_id<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_9-公示期等待-进入exectable" tabindex="-1"><a class="header-anchor" href="#_9-公示期等待-进入exectable" aria-hidden="true">#</a> 9. 公示期等待 进入EXECTABLE</h3><blockquote><p>公示期的等待时间过去之后，就可以进入执行阶段。dev下可以通过命令加速此阶段 <strong>加速进入：</strong></p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>加速时间：
    dev <span class="token function">sleep</span> -t <span class="token number">3600000</span>
生成块（生效时间）：
    dev gen-block
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_10-提交升级计划-进入etracted" tabindex="-1"><a class="header-anchor" href="#_10-提交升级计划-进入etracted" aria-hidden="true">#</a> 10. 提交升级计划 进入ETRACTED</h3><blockquote><p>这一步是可执行阶段，可以执行升级计划。</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dev module-plan -i <span class="token operator">&lt;</span>proposal_id<span class="token operator">&gt;</span> -a <span class="token operator">&lt;</span>proposal address<span class="token operator">&gt;</span>  -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_11-提交代码-进入upgrade-complete" tabindex="-1"><a class="header-anchor" href="#_11-提交代码-进入upgrade-complete" aria-hidden="true">#</a> 11. 提交代码 进入Upgrade complete</h3><blockquote><p>在这一步中Dao流程已经结束，两阶段提交流程进入最后一阶段 <strong>代码模块提交：</strong></p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dev module_exe -m path/to/storage/MymintUpgrade.blob -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_12-完成合约升级流程" tabindex="-1"><a class="header-anchor" href="#_12-完成合约升级流程" aria-hidden="true">#</a> 12. 完成合约升级流程</h3><blockquote><p>至此已经完成整个合约升级过程</p></blockquote><h3 id="_13-升级的验证" tabindex="-1"><a class="header-anchor" href="#_13-升级的验证" aria-hidden="true">#</a> 13. 升级的验证</h3><blockquote><p>可以执行DummyTokenScripts模块中的 Mymint函数来校验是否升级成功</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>执行获取DummyToken <span class="token number">100</span>个：
    account execute-function --function 0x1::DummyTokenScripts::Mymint -b -s <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span>
查看DummyToken：
    account show <span class="token operator">&lt;</span>account address<span class="token operator">&gt;</span>
结果：
    <span class="token string">&quot;balances&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;0x00000000000000000000000000000001::DummyToken::DummyToken&quot;</span><span class="token builtin class-name">:</span> <span class="token number">100</span>,
      <span class="token string">&quot;0x00000000000000000000000000000001::STC::STC&quot;</span><span class="token builtin class-name">:</span> <span class="token number">9999645054</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">最后修改于: </span><span class="meta-item-info">2021/9/8 上午3:47:17</span></div><!----></footer><!----><!--[--><!--[--><div class="my-footer">MIT Licensed | Copyright © 2021-present 不霁何虹</div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.fa156efa.js" defer></script><script src="/assets/js/1773.b136e78e.js" defer></script><script src="/assets/js/app.7a04ff8e.js" defer></script>
  </body>
</html>
